pipeline {
    agent any
    
    environment {
        ANGULAR_CLI_VERSION = '14.1.0' // Change this to your desired Angular CLI version
        ANGULAR_APP_DIRECTORY = 'D:\\PWA\\angular-pwa' // Change this to your Angular app directory
    }

    stages {
        stage('Checkout') {
            steps {
                echo 'Checking out source code...'
                git 'https://github.com/UsmanSaddique/pwaSample'
            }
        }
        
        stage('Build') {
            steps {
                echo 'Building Angular app...'
                // Install Angular CLI
                sh "npm install -g @angular/cli@${ANGULAR_CLI_VERSION}"
                echo 'Angular CLI installed...'
                
                // Install project dependencies
                sh "cd ${ANGULAR_APP_DIRECTORY} && npm install"
                echo 'Project dependencies installed...'
                
                // Build Angular app
                sh "cd ${ANGULAR_APP_DIRECTORY} && ng build --prod"
                echo 'Angular app built...'
            }
        }
        
        stage('Deploy') {
            steps {
                echo 'Deploying Angular app...'
                // Deploy Angular app to local server
                sh "cd ${ANGULAR_APP_DIRECTORY}/dist && http-server -p 8081"
            }
        }
    }
}
